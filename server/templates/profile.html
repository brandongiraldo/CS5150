<!-- extend base layout -->
{% extends "base.html" %}
{% block content %}

<div class="spacer"></div>

  <!-- Nav tabs -->
  <ul class="nav nav-tabs" role="tablist">
    <li role="presentation" class="active"><a href="#myprofile" aria-controls="myprofile" role="tab" data-toggle="tab">My Profile</a></li>
    <li role="presentation"><a href="#starred" aria-controls="starred" role="tab" data-toggle="tab">Starred Posts</a></li>
  </ul>

  <!-- Tab panes -->
  <div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="myprofile">

    <form method="POST">    
        <div class="profile">
            <div class="header card">
                <div class="name">{{profile.name}}</div>
                <br>
                <div class="form-group">
                    <label>Major</label>
                    <p>{{profile.major}}</p>
                    <!-- <p>aa: {{starred}}</p> -->
                </div>

                <div class="form-group">
                    <label>Email</label>
                    <input class="form-control" type="text" name="user_email" value="{{profile.email}}">
                </div>

                <div class="form-group">
                    <label>Year</label><br>
                    <select id="user_year_select" name="user_year" class="form-control">
                      <option value="Freshman">Freshman</option>
                      <option value="Sophomore">Sophomore</option>
                      <option value="Junior">Junior</option>
                      <option value="Senior">Senior</option>
                      <option value="Graduate">Graduate</option>
                      <option value="Post-graduate">Post-graduate</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Bio &amp; Experience</label><br>
                    <textarea name="user_description" rows="5" class="form-control">{{profile.description}}</textarea>
                </div>
                <div class="form-group availability">
                    <label>Availability</label><br>
                    <div class="checkbox">
                        <label>
                          <input type="checkbox"> Monday
                        </label>
                    </div>
                    <div class="times-form"></div>
                    <div class="checkbox">
                        <label>
                          <input type="checkbox"> Tuesday
                        </label>
                    </div>
                    <div class="times-form"></div>
                    <div class="checkbox">
                        <label>
                          <input type="checkbox"> Wednessday
                        </label>
                    </div>
                    <div class="times-form"></div>
                    <div class="checkbox">
                        <label>
                          <input type="checkbox"> Thursday
                        </label>
                    </div>
                    <div class="times-form"></div>
                    <div class="checkbox">
                        <label>
                          <input type="checkbox"> Friday
                        </label>
                    </div>
                    <div class="times-form"></div>
                </div>
                <div class="form-group typeahead">
                    <label>Skills</label><br>
                    <input autocomplete="off" class="tags-input" type="text" value="" data-role="tagsinput"/>
                </div>
                <div class="form-group">
                    <label>Research Interests</label><br>
                    <input autocomplete="off" class="tags-input" type="text" value="" data-role="tagsinput"/>
                </div>
                <label class="resume">
                    <input id="resume-upload" type="file"/>
                    <i class="fa fa-cloud-upload"></i> Upload Reusme
                </label>
                <span class="file-selected"></span>
                <input id="save-profile-updates" type="submit" value="Save Updates" class="btn btn-primary">
            </div>
        </div>


        </form>

    </div>
    <div role="tabpanel" class="tab-pane" id="starred">
        {% if favorited_projects %}
            {% for post in favorited_projects %}        
                {% include "partials/post.html" %}
            {% endfor %}
        {% else %}
            <div class="profile">
                <div class="card">
                    <h2>You have no starred posts</h2>
                </div>
            </div>
        {% endif %}
    </div>
  </div>


    <script type="text/javascript">
        profile = '{{profile}}';
        console.log(profile);
        $('#user_year_select option').each(function() {
          if ($(this).val() == "{{ profile.year }}") {
            $(this).prop('selected','selected');
          }
        });
        $(document).on("change keyup", "input, select, textarea", function () {
            $('#save-profile-updates').css('display', 'block');
        });
        $('#resume-upload').bind('change', function() {
            fileName = $(this).val().substring($(this).val().lastIndexOf("\\")+1);
            $('.file-selected').html(fileName); 
        });
        $('.checkbox').on("click", function() {
            // need an endpoint to load files from templates
            $(this).load("templates/partials/optional-times-form.html .times-form");
        });
        $('.typeahead input').tagsinput({
            typeahead: {
                source: ['C++', 'Java', 'Test', 'Something', 'OK']
            },
            freeInput: false,
            // Typeahead fix
            onTagExists: function() {
                setTimeout(function() {
                    $(">input[type=text]",".bootstrap-tagsinput").val("");
                }, 1);
            }
        });
        // Typeahead fix
        $('.typeahead input').on('itemAdded', function(event) {
            setTimeout(function(){
                $(">input[type=text]",".bootstrap-tagsinput").val("");
            }, 1);
        });
        // No Enter button
        $(window).keydown(function(event){
            if(event.keyCode == 13) {
                event.preventDefault();
                return false;
            }
        });
    </script>

{% endblock %}